################################ Mutation signIn ################################

"User info received from authentication provider"
type AuthProviderUser {
  "User ID"
  id: ID!
  "User email. Not stored in database and only available with sign in payload."
  email: String!
}

input GoogleJWTAuthInput {
  "JSON Web Token"
  token: String!
}

input SignInInput {
  auth: GoogleJWTAuthInput!
}

interface SignInResult {
  "Signed in user"
  signedInUser: SignedInUser!
  "SignedInUser.id's"
  availableUserIds: [String!]!
}

type JustSignedInResult implements SignInResult {
  "Just signed in user"
  signedInUser: SignedInUser!
  "Available SignedInUser.id's after sign in"
  availableUserIds: [String!]!
  "User info from auth provider"
  authProviderUser: AuthProviderUser!
}

type AlreadySignedInResult implements SignInResult {
  "Current already signed in user"
  signedInUser: SignedInUser!
  "Current available SignedInUser.id's"
  availableUserIds: [String!]!
}
union SignInPayload = JustSignedInResult | AlreadySignedInResult

extend type Mutation {
  "Sign in using an auth provider"
  signIn(input: SignInInput!): SignInPayload!
}

################################ Mutation signOut ################################

"Sign out of current session unless allSessions or sessionId is specified"
input SignOutInput {
  " Sign out a specific user by SignedInUser.id. If userId is not specified then all known users are signed out."
  userId: ObjectID!
}

type SignOutPayload {
  "Available SignedInUser.id's after sign out."
  availableUserIds: [String!]!
}

type SignOutFailedError implements Error {
  message: String!
}

extend type Mutation {
  "Sign out a user"
  signOut(input: SignOutInput): SignOutPayload!
}

################################ Mutation syncSessionCookies ################################

input SyncSessionCookiesInput {
  "Available user ids provided by the client"
  availableUserIds: [String!]!
}

type SyncSessionCookiesPayload {
  "User ids available in http-only cookies. Any other user id is expired."
  availableUserIds: [String!]!
}

extend type Mutation {
  "Synchronize http-only session cookies. Only sessions available both in client and server are kept."
  syncSessionCookies(input: SyncSessionCookiesInput!): SyncSessionCookiesPayload!
}
