extend type Query {
  "Session count saved in http-only cookie"
  sessionCount: NonNegativeInt!
}

enum AuthProvider {
  GOOGLE
}

"User info that is only available during sign in process and is not stored in database."
type AuthProviderUserInfo {
  "User ID"
  id: ID!
  "User email. Not stored in database and only available after sign in."
  email: String!
}

input CredentialsInput {
  token: String!
}

input SignInInput {
  provider: AuthProvider!
  credentials: CredentialsInput!
}
type SignInPayload {
  "session ID in http-only cookie."
  currentSessionId: String!
  "Signed in user info."
  userInfo: UserInfo!
  "User info available only during sign in from auth provider."
  authProviderUserInfo: AuthProviderUserInfo!
}
extend type Mutation {
  "On successful sign in, session ID is stored in a http-only cookie. Returns null on failed sign in."
  signIn(input: SignInInput!): SignInPayload
}

"Sign out of current session unless allSessions or sessionId is specified."
input SignOutInput {
  "Sign out of all session. Cookies are cleared."
  allSessions: Boolean
  "Sign out of specific session. This has no effect if allSessions is true."
  sessionId: String
}
type SignOutPayload {
  "User was signed out."
  signedOut: Boolean!
  "SessionId after signing out if other sessions still exists."
  currentSessionId: String
}
extend type Mutation {
  "Returns signed out http-conly cookie session index or null if user was not signed in."
  signOut(input: SignOutInput): SignOutPayload!
}

input SwitchToSessionInput {
  switchToSessionId: String!
}
type SwitchToSessionPayload {
  "Current session ID in http-only cookie"
  currentSessionId: String!
}
extend type Mutation {
  "Switch session to new index which is tied to http-only session cookie. Returns switched to session index."
  switchToSession(input: SwitchToSessionInput!): SwitchToSessionPayload
}

input SyncSessionsInput {
  "Client stored session Ids."
  availableSessionIds: [String!]!
}

type SyncSessionsSignInPayload {
  "Restored session ID"
  currentSessionId: String!
  "Session Ids available in http-only cookies"
  availableSessionIds: [String!]!
}

type SyncSessionsSignOutPayload {
  "Signed out. No existing sessions found."
  signedOut: Boolean!
}

union SyncSessionsUnionPayload = SyncSessionsSignInPayload | SyncSessionsSignOutPayload

extend type Mutation {
  "Call when session cookies are in invalid state. Server will fix cookies by setting new headers."
  syncSessions(input: SyncSessionsInput!): SyncSessionsUnionPayload!
}
